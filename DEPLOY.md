# Инструкция по деплою

## Подготовка

1. Убедитесь, что на сервере установлен Docker и Docker Compose
2. Скопируйте все файлы проекта на сервер

## Деплой

1. Перейдите в директорию проекта
2. Запустите контейнеры:

```bash
docker compose up -d
```

## Что происходит при запуске

1. PostgreSQL запускается и инициализирует базу данных
   - Если база данных пустая, данные будут загружены из файла бэкапа `testai_backup.sql`
   - Если база данных уже содержит таблицы, загрузка данных будет пропущена

2. .NET приложение запускается и:
   - Ждет, пока PostgreSQL станет доступен
   - Применяет все миграции Entity Framework Core
   - Запускает веб-сервер

3. Nginx запускается и настраивает маршрутизацию запросов

## Проверка статуса

Чтобы проверить статус контейнеров:

```bash
docker compose ps
```

Чтобы посмотреть логи:

```bash
docker compose logs -f
```

## Обновление

Для обновления приложения:

1. Остановите контейнеры:

```bash
docker compose down
```

2. Обновите файлы проекта
3. Запустите контейнеры снова:

```bash
docker compose up -d --build
```

## Резервное копирование базы данных

Для создания резервной копии базы данных:

```bash
docker compose exec postgres pg_dump -U postgres testai > backup_$(date +%Y%m%d).sql
``` 